import { Component, EventEmitter, Input, Output, } from '@angular/core';
import { StorageItemIconComponent, } from '../storage-item-icon/storage-item-icon.component';
import { MatTooltipModule } from '@angular/material/tooltip';
import { MatButtonModule } from '@angular/material/button';
import { MatIconModule } from '@angular/material/icon';
import { FormatBytesPipe } from '../../pipes/format-bytes.pipe';
import { DatePipe, NgOptimizedImage } from '@angular/common';
import * as i0 from "@angular/core";
import * as i1 from "../../services/console-logger.service";
import * as i2 from "../../services/firebase-storage.service";
import * as i3 from "@angular/material/tooltip";
import * as i4 from "@angular/material/button";
import * as i5 from "@angular/material/icon";
export class StorageFilePreviewComponent {
    constructor(cLog, storageService) {
        this.cLog = cLog;
        this.storageService = storageService;
        /**
         * Emits an event when the preview should be closed.
         * @event
         */
        this._close = new EventEmitter();
        /**
         * Indicates whether an error occurred while generating the file preview URL.
         */
        this.previewError = false;
    }
    ngOnChanges() {
        if (!this.item)
            return;
        /**
         * Fetches the download URL for the new file and updates the preview state.
         */
        const fileRef = this.storageService.getRef(this.item.fullPath);
        this.storageService.getDownloadURL(fileRef)
            .then((downloadURL) => {
            this.previewError = false;
            this.downloadURL = downloadURL;
        }).catch((error) => {
            this.cLog.error(`Error getting download URL for '${this.item?.name}'`, error, this.item);
        });
    }
    /**
     * Emits the '_close' event to signal that the preview should be closed.
     */
    closePreview() {
        this._close.emit(undefined);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.3", ngImport: i0, type: StorageFilePreviewComponent, deps: [{ token: i1.ConsoleLoggerService }, { token: i2.FirebaseStorageService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "17.3.3", type: StorageFilePreviewComponent, isStandalone: true, selector: "anon-storage-file-preview", inputs: { item: "item" }, outputs: { _close: "_close" }, usesOnChanges: true, ngImport: i0, template: "@if (item) {\n  <div class=\"header\">\n    <div class=\"name\">\n      <anon-storage-item-icon [type]=\"item.type!\" [contentType]=\"item.contentType!\" />\n      <span matTooltipShowDelay=\"500\" [matTooltip]=\"item.name\">{{item.name}}</span>\n    </div>\n\n    <button mat-icon-button type=\"button\" (click)=\"closePreview()\">\n      <mat-icon fontIcon=\"close\" />\n    </button>\n  </div>\n\n  @if (downloadURL) {\n    <!-- eslint-disable-next-line @angular-eslint/template/no-call-expression -->\n    @if (item.contentType?.startsWith('image/')) {\n      <picture class=\"file-preview\">\n        <img fill [ngSrc]=\"downloadURL\" [alt]=\"item.fullPath\"\n             (error)=\"downloadURL=undefined;previewError=true\" />\n      </picture>\n      <!-- eslint-disable-next-line @angular-eslint/template/no-call-expression -->\n    } @else if (item.contentType?.startsWith('video/')) {\n      <video class=\"file-preview\" controls autoplay loop>\n        <source [type]=\"item.contentType\" [src]=\"downloadURL\"\n                (error)=\"downloadURL=undefined;previewError=true\"/>\n      </video>\n    }\n    <div class=\"download-btn\">\n      <a mat-stroked-button type=\"button\" color=\"primary\" target=\"_blank\" [href]=\"downloadURL\">\n        <mat-icon fontIcon=\"download\" />\n        <span>Download</span>\n      </a>\n    </div>\n  }\n  @if (previewError) {\n    <h3 class=\"file-preview\">Preview Not Available.</h3>\n  }\n\n  <dl class=\"metadata\">\n    <dt>Name</dt>\n    <dd><a class=\"download-link\" target=\"_blank\" [href]=\"downloadURL\">{{item.name}}</a></dd>\n\n    <dt>Size</dt>\n    <dd>{{item.size | formatBytes}}</dd>\n\n    <dt>Type</dt>\n    <dd>{{item.contentType}}</dd>\n\n    <dt>Created</dt>\n    <dd>{{item.timeCreated | date:'short'}}</dd>\n\n    <dt>Last modified</dt>\n    <dd>{{item.updated | date:'short'}}</dd>\n  </dl>\n}\n", styles: [":host{display:block;margin-left:-1.5rem;flex-shrink:0;border-left-width:1px;border-left-style:solid;height:100%}.header{display:flex;justify-content:space-between;align-items:center;padding:.5rem 1.5rem}.header .name{display:flex;align-items:center;overflow:hidden}.header .name span{display:inline-block;flex-grow:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.file-preview{display:grid;place-content:center;max-width:100%;max-height:250px;padding:.5rem 1.5rem;box-sizing:border-box}.file-preview img{position:relative!important}.metadata{padding:0 1.5rem .5rem}.download-link{overflow-wrap:break-word}.download-btn{display:flex;justify-content:center}\n"], dependencies: [{ kind: "component", type: StorageItemIconComponent, selector: "anon-storage-item-icon", inputs: ["type", "contentType"] }, { kind: "ngmodule", type: MatTooltipModule }, { kind: "directive", type: i3.MatTooltip, selector: "[matTooltip]", inputs: ["matTooltipPosition", "matTooltipPositionAtOrigin", "matTooltipDisabled", "matTooltipShowDelay", "matTooltipHideDelay", "matTooltipTouchGestures", "matTooltip", "matTooltipClass"], exportAs: ["matTooltip"] }, { kind: "ngmodule", type: MatButtonModule }, { kind: "component", type: i4.MatAnchor, selector: "a[mat-button], a[mat-raised-button], a[mat-flat-button], a[mat-stroked-button]", exportAs: ["matButton", "matAnchor"] }, { kind: "component", type: i4.MatIconButton, selector: "button[mat-icon-button]", exportAs: ["matButton"] }, { kind: "ngmodule", type: MatIconModule }, { kind: "component", type: i5.MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }, { kind: "pipe", type: FormatBytesPipe, name: "formatBytes" }, { kind: "pipe", type: DatePipe, name: "date" }, { kind: "directive", type: NgOptimizedImage, selector: "img[ngSrc]", inputs: ["ngSrc", "ngSrcset", "sizes", "width", "height", "loading", "priority", "loaderParams", "disableOptimizedSrcset", "fill", "placeholder", "placeholderConfig", "src", "srcset"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.3", ngImport: i0, type: StorageFilePreviewComponent, decorators: [{
            type: Component,
            args: [{ selector: 'anon-storage-file-preview', standalone: true, imports: [
                        StorageItemIconComponent,
                        MatTooltipModule,
                        MatButtonModule,
                        MatIconModule,
                        FormatBytesPipe,
                        DatePipe,
                        NgOptimizedImage,
                    ], template: "@if (item) {\n  <div class=\"header\">\n    <div class=\"name\">\n      <anon-storage-item-icon [type]=\"item.type!\" [contentType]=\"item.contentType!\" />\n      <span matTooltipShowDelay=\"500\" [matTooltip]=\"item.name\">{{item.name}}</span>\n    </div>\n\n    <button mat-icon-button type=\"button\" (click)=\"closePreview()\">\n      <mat-icon fontIcon=\"close\" />\n    </button>\n  </div>\n\n  @if (downloadURL) {\n    <!-- eslint-disable-next-line @angular-eslint/template/no-call-expression -->\n    @if (item.contentType?.startsWith('image/')) {\n      <picture class=\"file-preview\">\n        <img fill [ngSrc]=\"downloadURL\" [alt]=\"item.fullPath\"\n             (error)=\"downloadURL=undefined;previewError=true\" />\n      </picture>\n      <!-- eslint-disable-next-line @angular-eslint/template/no-call-expression -->\n    } @else if (item.contentType?.startsWith('video/')) {\n      <video class=\"file-preview\" controls autoplay loop>\n        <source [type]=\"item.contentType\" [src]=\"downloadURL\"\n                (error)=\"downloadURL=undefined;previewError=true\"/>\n      </video>\n    }\n    <div class=\"download-btn\">\n      <a mat-stroked-button type=\"button\" color=\"primary\" target=\"_blank\" [href]=\"downloadURL\">\n        <mat-icon fontIcon=\"download\" />\n        <span>Download</span>\n      </a>\n    </div>\n  }\n  @if (previewError) {\n    <h3 class=\"file-preview\">Preview Not Available.</h3>\n  }\n\n  <dl class=\"metadata\">\n    <dt>Name</dt>\n    <dd><a class=\"download-link\" target=\"_blank\" [href]=\"downloadURL\">{{item.name}}</a></dd>\n\n    <dt>Size</dt>\n    <dd>{{item.size | formatBytes}}</dd>\n\n    <dt>Type</dt>\n    <dd>{{item.contentType}}</dd>\n\n    <dt>Created</dt>\n    <dd>{{item.timeCreated | date:'short'}}</dd>\n\n    <dt>Last modified</dt>\n    <dd>{{item.updated | date:'short'}}</dd>\n  </dl>\n}\n", styles: [":host{display:block;margin-left:-1.5rem;flex-shrink:0;border-left-width:1px;border-left-style:solid;height:100%}.header{display:flex;justify-content:space-between;align-items:center;padding:.5rem 1.5rem}.header .name{display:flex;align-items:center;overflow:hidden}.header .name span{display:inline-block;flex-grow:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.file-preview{display:grid;place-content:center;max-width:100%;max-height:250px;padding:.5rem 1.5rem;box-sizing:border-box}.file-preview img{position:relative!important}.metadata{padding:0 1.5rem .5rem}.download-link{overflow-wrap:break-word}.download-btn{display:flex;justify-content:center}\n"] }]
        }], ctorParameters: () => [{ type: i1.ConsoleLoggerService }, { type: i2.FirebaseStorageService }], propDecorators: { item: [{
                type: Input
            }], _close: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RvcmFnZS1maWxlLXByZXZpZXcuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvYW5ndWxhci1maXJlYmFzZS1zdG9yYWdlLW1hbmFnZXIvc3JjL2xpYi9jb21wb25lbnRzL3N0b3JhZ2UtZmlsZS1wcmV2aWV3L3N0b3JhZ2UtZmlsZS1wcmV2aWV3LmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2FuZ3VsYXItZmlyZWJhc2Utc3RvcmFnZS1tYW5hZ2VyL3NyYy9saWIvY29tcG9uZW50cy9zdG9yYWdlLWZpbGUtcHJldmlldy9zdG9yYWdlLWZpbGUtcHJldmlldy5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQWEsTUFBTSxHQUNsRCxNQUFNLGVBQWUsQ0FBQztBQU12QixPQUFPLEVBQ0wsd0JBQXdCLEdBQ3pCLE1BQU0sa0RBQWtELENBQUM7QUFDMUQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDN0QsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQzNELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUN2RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFDaEUsT0FBTyxFQUFFLFFBQVEsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGlCQUFpQixDQUFDOzs7Ozs7O0FBa0I3RCxNQUFNLE9BQU8sMkJBQTJCO0lBd0J0QyxZQUNVLElBQTBCLEVBQzFCLGNBQXNDO1FBRHRDLFNBQUksR0FBSixJQUFJLENBQXNCO1FBQzFCLG1CQUFjLEdBQWQsY0FBYyxDQUF3QjtRQW5CaEQ7OztXQUdHO1FBRU0sV0FBTSxHQUE0QixJQUFJLFlBQVksRUFBYSxDQUFDO1FBT3pFOztXQUVHO1FBQ0gsaUJBQVksR0FBRyxLQUFLLENBQUM7SUFLbEIsQ0FBQztJQUVKLFdBQVc7UUFDVCxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUk7WUFBRSxPQUFPO1FBRXZCOztXQUVHO1FBQ0gsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUMvRCxJQUFJLENBQUMsY0FBYyxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUM7YUFDeEMsSUFBSSxDQUFDLENBQUMsV0FBVyxFQUFFLEVBQUU7WUFDcEIsSUFBSSxDQUFDLFlBQVksR0FBRyxLQUFLLENBQUM7WUFDMUIsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7UUFDakMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBb0IsRUFBRSxFQUFFO1lBQ2hDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUNiLG1DQUFtQyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksR0FBRyxFQUNyRCxLQUFLLEVBQ0wsSUFBSSxDQUFDLElBQUksQ0FDVixDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRUQ7O09BRUc7SUFDSCxZQUFZO1FBQ1YsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDOUIsQ0FBQzs4R0F0RFUsMkJBQTJCO2tHQUEzQiwyQkFBMkIsbUtDakN4Qyx5MURBc0RBLHV0QkQ5Qkksd0JBQXdCLG1HQUN4QixnQkFBZ0IsNFRBQ2hCLGVBQWUsd1RBQ2YsYUFBYSwrS0FDYixlQUFlLCtDQUNmLFFBQVEsNkNBQ1IsZ0JBQWdCOzsyRkFHUCwyQkFBMkI7a0JBZnZDLFNBQVM7K0JBQ0UsMkJBQTJCLGNBR3pCLElBQUksV0FDUDt3QkFDUCx3QkFBd0I7d0JBQ3hCLGdCQUFnQjt3QkFDaEIsZUFBZTt3QkFDZixhQUFhO3dCQUNiLGVBQWU7d0JBQ2YsUUFBUTt3QkFDUixnQkFBZ0I7cUJBQ2pCOzhIQU9ELElBQUk7c0JBREgsS0FBSztnQkFRRyxNQUFNO3NCQURkLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uQ2hhbmdlcywgT3V0cHV0LFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFN0b3JhZ2VGaWxlIH0gZnJvbSAnLi4vLi4vaW50ZXJmYWNlcyc7XG5pbXBvcnQge1xuICBGaXJlYmFzZVN0b3JhZ2VTZXJ2aWNlLFxufSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9maXJlYmFzZS1zdG9yYWdlLnNlcnZpY2UnO1xuaW1wb3J0IHsgRmlyZWJhc2VFcnJvciB9IGZyb20gJ0Bhbmd1bGFyL2ZpcmUvYXBwL2ZpcmViYXNlJztcbmltcG9ydCB7XG4gIFN0b3JhZ2VJdGVtSWNvbkNvbXBvbmVudCxcbn0gZnJvbSAnLi4vc3RvcmFnZS1pdGVtLWljb24vc3RvcmFnZS1pdGVtLWljb24uY29tcG9uZW50JztcbmltcG9ydCB7IE1hdFRvb2x0aXBNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC90b29sdGlwJztcbmltcG9ydCB7IE1hdEJ1dHRvbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2J1dHRvbic7XG5pbXBvcnQgeyBNYXRJY29uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvaWNvbic7XG5pbXBvcnQgeyBGb3JtYXRCeXRlc1BpcGUgfSBmcm9tICcuLi8uLi9waXBlcy9mb3JtYXQtYnl0ZXMucGlwZSc7XG5pbXBvcnQgeyBEYXRlUGlwZSwgTmdPcHRpbWl6ZWRJbWFnZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBDb25zb2xlTG9nZ2VyU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2NvbnNvbGUtbG9nZ2VyLnNlcnZpY2UnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdhbm9uLXN0b3JhZ2UtZmlsZS1wcmV2aWV3JyxcbiAgdGVtcGxhdGVVcmw6ICcuL3N0b3JhZ2UtZmlsZS1wcmV2aWV3LmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmw6ICcuL3N0b3JhZ2UtZmlsZS1wcmV2aWV3LmNvbXBvbmVudC5zY3NzJyxcbiAgc3RhbmRhbG9uZTogdHJ1ZSxcbiAgaW1wb3J0czogW1xuICAgIFN0b3JhZ2VJdGVtSWNvbkNvbXBvbmVudCxcbiAgICBNYXRUb29sdGlwTW9kdWxlLFxuICAgIE1hdEJ1dHRvbk1vZHVsZSxcbiAgICBNYXRJY29uTW9kdWxlLFxuICAgIEZvcm1hdEJ5dGVzUGlwZSxcbiAgICBEYXRlUGlwZSxcbiAgICBOZ09wdGltaXplZEltYWdlLFxuICBdLFxufSlcbmV4cG9ydCBjbGFzcyBTdG9yYWdlRmlsZVByZXZpZXdDb21wb25lbnQgaW1wbGVtZW50cyBPbkNoYW5nZXMge1xuICAvKipcbiAgICogVGhlIFN0b3JhZ2VGaWxlIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIGZpbGUgdG8gcHJldmlldy5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGl0ZW0/OiBTdG9yYWdlRmlsZTtcblxuICAvKipcbiAgICogRW1pdHMgYW4gZXZlbnQgd2hlbiB0aGUgcHJldmlldyBzaG91bGQgYmUgY2xvc2VkLlxuICAgKiBAZXZlbnRcbiAgICovXG4gIEBPdXRwdXQoKVxuICByZWFkb25seSBfY2xvc2U6IEV2ZW50RW1pdHRlcjx1bmRlZmluZWQ+ID0gbmV3IEV2ZW50RW1pdHRlcjx1bmRlZmluZWQ+KCk7XG5cbiAgLyoqXG4gICAqIFRoZSBkb3dubG9hZCBVUkwgZm9yIHRoZSBwcmV2aWV3ZWQgZmlsZSAoaWYgc3VjY2Vzc2Z1bGx5IGdlbmVyYXRlZCkuXG4gICAqL1xuICBkb3dubG9hZFVSTD86IHN0cmluZztcblxuICAvKipcbiAgICogSW5kaWNhdGVzIHdoZXRoZXIgYW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZ2VuZXJhdGluZyB0aGUgZmlsZSBwcmV2aWV3IFVSTC5cbiAgICovXG4gIHByZXZpZXdFcnJvciA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgY0xvZzogQ29uc29sZUxvZ2dlclNlcnZpY2UsXG4gICAgcHJpdmF0ZSBzdG9yYWdlU2VydmljZTogRmlyZWJhc2VTdG9yYWdlU2VydmljZSxcbiAgKSB7fVxuXG4gIG5nT25DaGFuZ2VzKCkge1xuICAgIGlmICghdGhpcy5pdGVtKSByZXR1cm47XG5cbiAgICAvKipcbiAgICAgKiBGZXRjaGVzIHRoZSBkb3dubG9hZCBVUkwgZm9yIHRoZSBuZXcgZmlsZSBhbmQgdXBkYXRlcyB0aGUgcHJldmlldyBzdGF0ZS5cbiAgICAgKi9cbiAgICBjb25zdCBmaWxlUmVmID0gdGhpcy5zdG9yYWdlU2VydmljZS5nZXRSZWYodGhpcy5pdGVtLmZ1bGxQYXRoKTtcbiAgICB0aGlzLnN0b3JhZ2VTZXJ2aWNlLmdldERvd25sb2FkVVJMKGZpbGVSZWYpXG4gICAgICAudGhlbigoZG93bmxvYWRVUkwpID0+IHtcbiAgICAgICAgdGhpcy5wcmV2aWV3RXJyb3IgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5kb3dubG9hZFVSTCA9IGRvd25sb2FkVVJMO1xuICAgICAgfSkuY2F0Y2goKGVycm9yOiBGaXJlYmFzZUVycm9yKSA9PiB7XG4gICAgICAgIHRoaXMuY0xvZy5lcnJvcihcbiAgICAgICAgICBgRXJyb3IgZ2V0dGluZyBkb3dubG9hZCBVUkwgZm9yICcke3RoaXMuaXRlbT8ubmFtZX0nYCxcbiAgICAgICAgICBlcnJvcixcbiAgICAgICAgICB0aGlzLml0ZW0sXG4gICAgICAgICk7XG4gICAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbWl0cyB0aGUgJ19jbG9zZScgZXZlbnQgdG8gc2lnbmFsIHRoYXQgdGhlIHByZXZpZXcgc2hvdWxkIGJlIGNsb3NlZC5cbiAgICovXG4gIGNsb3NlUHJldmlldygpIHtcbiAgICB0aGlzLl9jbG9zZS5lbWl0KHVuZGVmaW5lZCk7XG4gIH1cbn1cbiIsIkBpZiAoaXRlbSkge1xuICA8ZGl2IGNsYXNzPVwiaGVhZGVyXCI+XG4gICAgPGRpdiBjbGFzcz1cIm5hbWVcIj5cbiAgICAgIDxhbm9uLXN0b3JhZ2UtaXRlbS1pY29uIFt0eXBlXT1cIml0ZW0udHlwZSFcIiBbY29udGVudFR5cGVdPVwiaXRlbS5jb250ZW50VHlwZSFcIiAvPlxuICAgICAgPHNwYW4gbWF0VG9vbHRpcFNob3dEZWxheT1cIjUwMFwiIFttYXRUb29sdGlwXT1cIml0ZW0ubmFtZVwiPnt7aXRlbS5uYW1lfX08L3NwYW4+XG4gICAgPC9kaXY+XG5cbiAgICA8YnV0dG9uIG1hdC1pY29uLWJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgKGNsaWNrKT1cImNsb3NlUHJldmlldygpXCI+XG4gICAgICA8bWF0LWljb24gZm9udEljb249XCJjbG9zZVwiIC8+XG4gICAgPC9idXR0b24+XG4gIDwvZGl2PlxuXG4gIEBpZiAoZG93bmxvYWRVUkwpIHtcbiAgICA8IS0tIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvdGVtcGxhdGUvbm8tY2FsbC1leHByZXNzaW9uIC0tPlxuICAgIEBpZiAoaXRlbS5jb250ZW50VHlwZT8uc3RhcnRzV2l0aCgnaW1hZ2UvJykpIHtcbiAgICAgIDxwaWN0dXJlIGNsYXNzPVwiZmlsZS1wcmV2aWV3XCI+XG4gICAgICAgIDxpbWcgZmlsbCBbbmdTcmNdPVwiZG93bmxvYWRVUkxcIiBbYWx0XT1cIml0ZW0uZnVsbFBhdGhcIlxuICAgICAgICAgICAgIChlcnJvcik9XCJkb3dubG9hZFVSTD11bmRlZmluZWQ7cHJldmlld0Vycm9yPXRydWVcIiAvPlxuICAgICAgPC9waWN0dXJlPlxuICAgICAgPCEtLSBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQGFuZ3VsYXItZXNsaW50L3RlbXBsYXRlL25vLWNhbGwtZXhwcmVzc2lvbiAtLT5cbiAgICB9IEBlbHNlIGlmIChpdGVtLmNvbnRlbnRUeXBlPy5zdGFydHNXaXRoKCd2aWRlby8nKSkge1xuICAgICAgPHZpZGVvIGNsYXNzPVwiZmlsZS1wcmV2aWV3XCIgY29udHJvbHMgYXV0b3BsYXkgbG9vcD5cbiAgICAgICAgPHNvdXJjZSBbdHlwZV09XCJpdGVtLmNvbnRlbnRUeXBlXCIgW3NyY109XCJkb3dubG9hZFVSTFwiXG4gICAgICAgICAgICAgICAgKGVycm9yKT1cImRvd25sb2FkVVJMPXVuZGVmaW5lZDtwcmV2aWV3RXJyb3I9dHJ1ZVwiLz5cbiAgICAgIDwvdmlkZW8+XG4gICAgfVxuICAgIDxkaXYgY2xhc3M9XCJkb3dubG9hZC1idG5cIj5cbiAgICAgIDxhIG1hdC1zdHJva2VkLWJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY29sb3I9XCJwcmltYXJ5XCIgdGFyZ2V0PVwiX2JsYW5rXCIgW2hyZWZdPVwiZG93bmxvYWRVUkxcIj5cbiAgICAgICAgPG1hdC1pY29uIGZvbnRJY29uPVwiZG93bmxvYWRcIiAvPlxuICAgICAgICA8c3Bhbj5Eb3dubG9hZDwvc3Bhbj5cbiAgICAgIDwvYT5cbiAgICA8L2Rpdj5cbiAgfVxuICBAaWYgKHByZXZpZXdFcnJvcikge1xuICAgIDxoMyBjbGFzcz1cImZpbGUtcHJldmlld1wiPlByZXZpZXcgTm90IEF2YWlsYWJsZS48L2gzPlxuICB9XG5cbiAgPGRsIGNsYXNzPVwibWV0YWRhdGFcIj5cbiAgICA8ZHQ+TmFtZTwvZHQ+XG4gICAgPGRkPjxhIGNsYXNzPVwiZG93bmxvYWQtbGlua1wiIHRhcmdldD1cIl9ibGFua1wiIFtocmVmXT1cImRvd25sb2FkVVJMXCI+e3tpdGVtLm5hbWV9fTwvYT48L2RkPlxuXG4gICAgPGR0PlNpemU8L2R0PlxuICAgIDxkZD57e2l0ZW0uc2l6ZSB8IGZvcm1hdEJ5dGVzfX08L2RkPlxuXG4gICAgPGR0PlR5cGU8L2R0PlxuICAgIDxkZD57e2l0ZW0uY29udGVudFR5cGV9fTwvZGQ+XG5cbiAgICA8ZHQ+Q3JlYXRlZDwvZHQ+XG4gICAgPGRkPnt7aXRlbS50aW1lQ3JlYXRlZCB8IGRhdGU6J3Nob3J0J319PC9kZD5cblxuICAgIDxkdD5MYXN0IG1vZGlmaWVkPC9kdD5cbiAgICA8ZGQ+e3tpdGVtLnVwZGF0ZWQgfCBkYXRlOidzaG9ydCd9fTwvZGQ+XG4gIDwvZGw+XG59XG4iXX0=