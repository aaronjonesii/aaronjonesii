import { Component, EventEmitter, Input, Output } from '@angular/core';
import { StorageItemIconComponent } from "../storage-item-icon/storage-item-icon.component";
import { MatTooltipModule } from "@angular/material/tooltip";
import { MatButtonModule } from "@angular/material/button";
import { MatIconModule } from "@angular/material/icon";
import { FormatBytesPipe } from "../../pipes/format-bytes.pipe";
import { DatePipe, NgOptimizedImage } from "@angular/common";
import * as i0 from "@angular/core";
import * as i1 from "../../services/console-logger.service";
import * as i2 from "../../services/firebase-storage.service";
import * as i3 from "@angular/material/tooltip";
import * as i4 from "@angular/material/button";
import * as i5 from "@angular/material/icon";
export class StorageFilePreviewComponent {
    constructor(cLog, storageService) {
        this.cLog = cLog;
        this.storageService = storageService;
        /**
         * Emits an event when the preview should be closed.
         * @event
         */
        this._close = new EventEmitter();
        /**
         * Indicates whether an error occurred while generating the file preview URL.
         */
        this.previewError = false;
    }
    ngOnChanges() {
        if (!this.item)
            return;
        /** Fetches the download URL for the new file and updates the preview state. */
        const fileRef = this.storageService.getRef(this.item.fullPath);
        this.storageService.getDownloadURL(fileRef)
            .then((downloadURL) => {
            this.previewError = false;
            this.downloadURL = downloadURL;
        }).catch((error) => {
            this.cLog.error(`Error getting download URL for '${this.item?.name}'`, error, this.item);
        });
    }
    /**
     * Emits the '_close' event to signal that the preview should be closed.
     */
    closePreview() {
        this._close.emit(undefined);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.3", ngImport: i0, type: StorageFilePreviewComponent, deps: [{ token: i1.ConsoleLoggerService }, { token: i2.FirebaseStorageService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "17.3.3", type: StorageFilePreviewComponent, isStandalone: true, selector: "anon-storage-file-preview", inputs: { item: "item" }, outputs: { _close: "_close" }, usesOnChanges: true, ngImport: i0, template: "@if (item) {\n  <div class=\"header\">\n    <div class=\"name\">\n      <anon-storage-item-icon [type]=\"item.type!\" [contentType]=\"item.contentType!\" />\n      <span matTooltipShowDelay=\"500\" [matTooltip]=\"item.name\">{{item.name}}</span>\n    </div>\n\n    <button mat-icon-button type=\"button\" (click)=\"closePreview()\">\n      <mat-icon fontIcon=\"close\" />\n    </button>\n  </div>\n\n  @if (downloadURL) {\n    <!-- eslint-disable-next-line @angular-eslint/template/no-call-expression -->\n    @if (item.contentType?.startsWith('image/')) {\n      <picture class=\"file-preview\">\n        <img fill [ngSrc]=\"downloadURL\" [alt]=\"item.fullPath\"\n             (error)=\"downloadURL=undefined;previewError=true\" />\n      </picture>\n      <!-- eslint-disable-next-line @angular-eslint/template/no-call-expression -->\n    } @else if (item.contentType?.startsWith('video/')) {\n      <video class=\"file-preview\" controls autoplay loop>\n        <source [type]=\"item.contentType\" [src]=\"downloadURL\"\n                (error)=\"downloadURL=undefined;previewError=true\"/>\n      </video>\n    }\n    <div class=\"download-btn\">\n      <a mat-stroked-button type=\"button\" color=\"primary\" target=\"_blank\" [href]=\"downloadURL\">\n        <mat-icon fontIcon=\"download\" />\n        <span>Download</span>\n      </a>\n    </div>\n  }\n  @if (previewError) {\n    <h3 class=\"file-preview\">Preview Not Available.</h3>\n  }\n\n  <dl class=\"metadata\">\n    <dt>Name</dt>\n    <dd><a class=\"download-link\" target=\"_blank\" [href]=\"downloadURL\">{{item.name}}</a></dd>\n\n    <dt>Size</dt>\n    <dd>{{item.size | formatBytes}}</dd>\n\n    <dt>Type</dt>\n    <dd>{{item.contentType}}</dd>\n\n    <dt>Created</dt>\n    <dd>{{item.timeCreated | date:'short'}}</dd>\n\n    <dt>Last modified</dt>\n    <dd>{{item.updated | date:'short'}}</dd>\n  </dl>\n}\n", styles: [":host{display:block;margin-left:-1.5rem;flex-shrink:0;border-left-width:1px;border-left-style:solid;height:100%}.header{display:flex;justify-content:space-between;align-items:center;padding:.5rem 1.5rem}.header .name{display:flex;align-items:center;overflow:hidden}.header .name span{display:inline-block;flex-grow:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.file-preview{display:grid;place-content:center;max-width:100%;max-height:250px;padding:.5rem 1.5rem;box-sizing:border-box}.file-preview img{position:relative!important}.metadata{padding:0 1.5rem .5rem}.download-link{overflow-wrap:break-word}.download-btn{display:flex;justify-content:center}\n"], dependencies: [{ kind: "component", type: StorageItemIconComponent, selector: "anon-storage-item-icon", inputs: ["type", "contentType"] }, { kind: "ngmodule", type: MatTooltipModule }, { kind: "directive", type: i3.MatTooltip, selector: "[matTooltip]", inputs: ["matTooltipPosition", "matTooltipPositionAtOrigin", "matTooltipDisabled", "matTooltipShowDelay", "matTooltipHideDelay", "matTooltipTouchGestures", "matTooltip", "matTooltipClass"], exportAs: ["matTooltip"] }, { kind: "ngmodule", type: MatButtonModule }, { kind: "component", type: i4.MatAnchor, selector: "a[mat-button], a[mat-raised-button], a[mat-flat-button], a[mat-stroked-button]", exportAs: ["matButton", "matAnchor"] }, { kind: "component", type: i4.MatIconButton, selector: "button[mat-icon-button]", exportAs: ["matButton"] }, { kind: "ngmodule", type: MatIconModule }, { kind: "component", type: i5.MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }, { kind: "pipe", type: FormatBytesPipe, name: "formatBytes" }, { kind: "pipe", type: DatePipe, name: "date" }, { kind: "directive", type: NgOptimizedImage, selector: "img[ngSrc]", inputs: ["ngSrc", "ngSrcset", "sizes", "width", "height", "loading", "priority", "loaderParams", "disableOptimizedSrcset", "fill", "placeholder", "placeholderConfig", "src", "srcset"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.3", ngImport: i0, type: StorageFilePreviewComponent, decorators: [{
            type: Component,
            args: [{ selector: 'anon-storage-file-preview', standalone: true, imports: [
                        StorageItemIconComponent,
                        MatTooltipModule,
                        MatButtonModule,
                        MatIconModule,
                        FormatBytesPipe,
                        DatePipe,
                        NgOptimizedImage,
                    ], template: "@if (item) {\n  <div class=\"header\">\n    <div class=\"name\">\n      <anon-storage-item-icon [type]=\"item.type!\" [contentType]=\"item.contentType!\" />\n      <span matTooltipShowDelay=\"500\" [matTooltip]=\"item.name\">{{item.name}}</span>\n    </div>\n\n    <button mat-icon-button type=\"button\" (click)=\"closePreview()\">\n      <mat-icon fontIcon=\"close\" />\n    </button>\n  </div>\n\n  @if (downloadURL) {\n    <!-- eslint-disable-next-line @angular-eslint/template/no-call-expression -->\n    @if (item.contentType?.startsWith('image/')) {\n      <picture class=\"file-preview\">\n        <img fill [ngSrc]=\"downloadURL\" [alt]=\"item.fullPath\"\n             (error)=\"downloadURL=undefined;previewError=true\" />\n      </picture>\n      <!-- eslint-disable-next-line @angular-eslint/template/no-call-expression -->\n    } @else if (item.contentType?.startsWith('video/')) {\n      <video class=\"file-preview\" controls autoplay loop>\n        <source [type]=\"item.contentType\" [src]=\"downloadURL\"\n                (error)=\"downloadURL=undefined;previewError=true\"/>\n      </video>\n    }\n    <div class=\"download-btn\">\n      <a mat-stroked-button type=\"button\" color=\"primary\" target=\"_blank\" [href]=\"downloadURL\">\n        <mat-icon fontIcon=\"download\" />\n        <span>Download</span>\n      </a>\n    </div>\n  }\n  @if (previewError) {\n    <h3 class=\"file-preview\">Preview Not Available.</h3>\n  }\n\n  <dl class=\"metadata\">\n    <dt>Name</dt>\n    <dd><a class=\"download-link\" target=\"_blank\" [href]=\"downloadURL\">{{item.name}}</a></dd>\n\n    <dt>Size</dt>\n    <dd>{{item.size | formatBytes}}</dd>\n\n    <dt>Type</dt>\n    <dd>{{item.contentType}}</dd>\n\n    <dt>Created</dt>\n    <dd>{{item.timeCreated | date:'short'}}</dd>\n\n    <dt>Last modified</dt>\n    <dd>{{item.updated | date:'short'}}</dd>\n  </dl>\n}\n", styles: [":host{display:block;margin-left:-1.5rem;flex-shrink:0;border-left-width:1px;border-left-style:solid;height:100%}.header{display:flex;justify-content:space-between;align-items:center;padding:.5rem 1.5rem}.header .name{display:flex;align-items:center;overflow:hidden}.header .name span{display:inline-block;flex-grow:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.file-preview{display:grid;place-content:center;max-width:100%;max-height:250px;padding:.5rem 1.5rem;box-sizing:border-box}.file-preview img{position:relative!important}.metadata{padding:0 1.5rem .5rem}.download-link{overflow-wrap:break-word}.download-btn{display:flex;justify-content:center}\n"] }]
        }], ctorParameters: () => [{ type: i1.ConsoleLoggerService }, { type: i2.FirebaseStorageService }], propDecorators: { item: [{
                type: Input
            }], _close: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RvcmFnZS1maWxlLXByZXZpZXcuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvYW5ndWxhci1maXJlYmFzZS1zdG9yYWdlLW1hbmFnZXIvc3JjL2xpYi9jb21wb25lbnRzL3N0b3JhZ2UtZmlsZS1wcmV2aWV3L3N0b3JhZ2UtZmlsZS1wcmV2aWV3LmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2FuZ3VsYXItZmlyZWJhc2Utc3RvcmFnZS1tYW5hZ2VyL3NyYy9saWIvY29tcG9uZW50cy9zdG9yYWdlLWZpbGUtcHJldmlldy9zdG9yYWdlLWZpbGUtcHJldmlldy5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQWEsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBSWxGLE9BQU8sRUFDTCx3QkFBd0IsRUFDekIsTUFBTSxrREFBa0QsQ0FBQztBQUMxRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUM3RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDM0QsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUNoRSxPQUFPLEVBQUUsUUFBUSxFQUFFLGdCQUFnQixFQUFFLE1BQU0saUJBQWlCLENBQUM7Ozs7Ozs7QUFrQjdELE1BQU0sT0FBTywyQkFBMkI7SUF3QnRDLFlBQ1UsSUFBMEIsRUFDMUIsY0FBc0M7UUFEdEMsU0FBSSxHQUFKLElBQUksQ0FBc0I7UUFDMUIsbUJBQWMsR0FBZCxjQUFjLENBQXdCO1FBbkJoRDs7O1dBR0c7UUFFTSxXQUFNLEdBQTRCLElBQUksWUFBWSxFQUFhLENBQUM7UUFPekU7O1dBRUc7UUFDSCxpQkFBWSxHQUFHLEtBQUssQ0FBQztJQUtsQixDQUFDO0lBRUosV0FBVztRQUNULElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSTtZQUFFLE9BQU87UUFFdkIsK0VBQStFO1FBQy9FLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDL0QsSUFBSSxDQUFDLGNBQWMsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDO2FBQ3hDLElBQUksQ0FBQyxDQUFDLFdBQVcsRUFBRSxFQUFFO1lBQ3BCLElBQUksQ0FBQyxZQUFZLEdBQUcsS0FBSyxDQUFDO1lBQzFCLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO1FBQ2pDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEtBQW9CLEVBQUUsRUFBRTtZQUNoQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FDYixtQ0FBbUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEdBQUcsRUFDckQsS0FBSyxFQUNMLElBQUksQ0FBQyxJQUFJLENBQ1YsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOztPQUVHO0lBQ0gsWUFBWTtRQUNWLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQzlCLENBQUM7OEdBcERVLDJCQUEyQjtrR0FBM0IsMkJBQTJCLG1LQzdCeEMseTFEQXNEQSx1dEJEbENJLHdCQUF3QixtR0FDeEIsZ0JBQWdCLDRUQUNoQixlQUFlLHdUQUNmLGFBQWEsK0tBQ2IsZUFBZSwrQ0FDZixRQUFRLDZDQUNSLGdCQUFnQjs7MkZBR1AsMkJBQTJCO2tCQWZ2QyxTQUFTOytCQUNFLDJCQUEyQixjQUd6QixJQUFJLFdBQ1A7d0JBQ1Asd0JBQXdCO3dCQUN4QixnQkFBZ0I7d0JBQ2hCLGVBQWU7d0JBQ2YsYUFBYTt3QkFDYixlQUFlO3dCQUNmLFFBQVE7d0JBQ1IsZ0JBQWdCO3FCQUNqQjs4SEFPRCxJQUFJO3NCQURILEtBQUs7Z0JBUUcsTUFBTTtzQkFEZCxNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkNoYW5nZXMsIE91dHB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgU3RvcmFnZUZpbGUgfSBmcm9tICcuLi8uLi9pbnRlcmZhY2VzJztcbmltcG9ydCB7IEZpcmViYXNlU3RvcmFnZVNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9maXJlYmFzZS1zdG9yYWdlLnNlcnZpY2UnO1xuaW1wb3J0IHsgRmlyZWJhc2VFcnJvciB9IGZyb20gJ0Bhbmd1bGFyL2ZpcmUvYXBwL2ZpcmViYXNlJztcbmltcG9ydCB7XG4gIFN0b3JhZ2VJdGVtSWNvbkNvbXBvbmVudFxufSBmcm9tIFwiLi4vc3RvcmFnZS1pdGVtLWljb24vc3RvcmFnZS1pdGVtLWljb24uY29tcG9uZW50XCI7XG5pbXBvcnQgeyBNYXRUb29sdGlwTW9kdWxlIH0gZnJvbSBcIkBhbmd1bGFyL21hdGVyaWFsL3Rvb2x0aXBcIjtcbmltcG9ydCB7IE1hdEJ1dHRvbk1vZHVsZSB9IGZyb20gXCJAYW5ndWxhci9tYXRlcmlhbC9idXR0b25cIjtcbmltcG9ydCB7IE1hdEljb25Nb2R1bGUgfSBmcm9tIFwiQGFuZ3VsYXIvbWF0ZXJpYWwvaWNvblwiO1xuaW1wb3J0IHsgRm9ybWF0Qnl0ZXNQaXBlIH0gZnJvbSBcIi4uLy4uL3BpcGVzL2Zvcm1hdC1ieXRlcy5waXBlXCI7XG5pbXBvcnQgeyBEYXRlUGlwZSwgTmdPcHRpbWl6ZWRJbWFnZSB9IGZyb20gXCJAYW5ndWxhci9jb21tb25cIjtcbmltcG9ydCB7IENvbnNvbGVMb2dnZXJTZXJ2aWNlIH0gZnJvbSBcIi4uLy4uL3NlcnZpY2VzL2NvbnNvbGUtbG9nZ2VyLnNlcnZpY2VcIjtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYW5vbi1zdG9yYWdlLWZpbGUtcHJldmlldycsXG4gIHRlbXBsYXRlVXJsOiAnLi9zdG9yYWdlLWZpbGUtcHJldmlldy5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsOiAnLi9zdG9yYWdlLWZpbGUtcHJldmlldy5jb21wb25lbnQuc2NzcycsXG4gIHN0YW5kYWxvbmU6IHRydWUsXG4gIGltcG9ydHM6IFtcbiAgICBTdG9yYWdlSXRlbUljb25Db21wb25lbnQsXG4gICAgTWF0VG9vbHRpcE1vZHVsZSxcbiAgICBNYXRCdXR0b25Nb2R1bGUsXG4gICAgTWF0SWNvbk1vZHVsZSxcbiAgICBGb3JtYXRCeXRlc1BpcGUsXG4gICAgRGF0ZVBpcGUsXG4gICAgTmdPcHRpbWl6ZWRJbWFnZSxcbiAgXSxcbn0pXG5leHBvcnQgY2xhc3MgU3RvcmFnZUZpbGVQcmV2aWV3Q29tcG9uZW50IGltcGxlbWVudHMgT25DaGFuZ2VzIHtcbiAgLyoqXG4gICAqIFRoZSBTdG9yYWdlRmlsZSBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBmaWxlIHRvIHByZXZpZXcuXG4gICAqL1xuICBASW5wdXQoKVxuICBpdGVtPzogU3RvcmFnZUZpbGU7XG5cbiAgLyoqXG4gICAqIEVtaXRzIGFuIGV2ZW50IHdoZW4gdGhlIHByZXZpZXcgc2hvdWxkIGJlIGNsb3NlZC5cbiAgICogQGV2ZW50XG4gICAqL1xuICBAT3V0cHV0KClcbiAgcmVhZG9ubHkgX2Nsb3NlOiBFdmVudEVtaXR0ZXI8dW5kZWZpbmVkPiA9IG5ldyBFdmVudEVtaXR0ZXI8dW5kZWZpbmVkPigpO1xuXG4gIC8qKlxuICAgKiBUaGUgZG93bmxvYWQgVVJMIGZvciB0aGUgcHJldmlld2VkIGZpbGUgKGlmIHN1Y2Nlc3NmdWxseSBnZW5lcmF0ZWQpLlxuICAgKi9cbiAgZG93bmxvYWRVUkw/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEluZGljYXRlcyB3aGV0aGVyIGFuIGVycm9yIG9jY3VycmVkIHdoaWxlIGdlbmVyYXRpbmcgdGhlIGZpbGUgcHJldmlldyBVUkwuXG4gICAqL1xuICBwcmV2aWV3RXJyb3IgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGNMb2c6IENvbnNvbGVMb2dnZXJTZXJ2aWNlLFxuICAgIHByaXZhdGUgc3RvcmFnZVNlcnZpY2U6IEZpcmViYXNlU3RvcmFnZVNlcnZpY2UsXG4gICkge31cblxuICBuZ09uQ2hhbmdlcygpIHtcbiAgICBpZiAoIXRoaXMuaXRlbSkgcmV0dXJuO1xuXG4gICAgLyoqIEZldGNoZXMgdGhlIGRvd25sb2FkIFVSTCBmb3IgdGhlIG5ldyBmaWxlIGFuZCB1cGRhdGVzIHRoZSBwcmV2aWV3IHN0YXRlLiAqL1xuICAgIGNvbnN0IGZpbGVSZWYgPSB0aGlzLnN0b3JhZ2VTZXJ2aWNlLmdldFJlZih0aGlzLml0ZW0uZnVsbFBhdGgpO1xuICAgIHRoaXMuc3RvcmFnZVNlcnZpY2UuZ2V0RG93bmxvYWRVUkwoZmlsZVJlZilcbiAgICAgIC50aGVuKChkb3dubG9hZFVSTCkgPT4ge1xuICAgICAgICB0aGlzLnByZXZpZXdFcnJvciA9IGZhbHNlO1xuICAgICAgICB0aGlzLmRvd25sb2FkVVJMID0gZG93bmxvYWRVUkw7XG4gICAgICB9KS5jYXRjaCgoZXJyb3I6IEZpcmViYXNlRXJyb3IpID0+IHtcbiAgICAgICAgdGhpcy5jTG9nLmVycm9yKFxuICAgICAgICAgIGBFcnJvciBnZXR0aW5nIGRvd25sb2FkIFVSTCBmb3IgJyR7dGhpcy5pdGVtPy5uYW1lfSdgLFxuICAgICAgICAgIGVycm9yLFxuICAgICAgICAgIHRoaXMuaXRlbSxcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEVtaXRzIHRoZSAnX2Nsb3NlJyBldmVudCB0byBzaWduYWwgdGhhdCB0aGUgcHJldmlldyBzaG91bGQgYmUgY2xvc2VkLlxuICAgKi9cbiAgY2xvc2VQcmV2aWV3KCkge1xuICAgIHRoaXMuX2Nsb3NlLmVtaXQodW5kZWZpbmVkKTtcbiAgfVxufVxuIiwiQGlmIChpdGVtKSB7XG4gIDxkaXYgY2xhc3M9XCJoZWFkZXJcIj5cbiAgICA8ZGl2IGNsYXNzPVwibmFtZVwiPlxuICAgICAgPGFub24tc3RvcmFnZS1pdGVtLWljb24gW3R5cGVdPVwiaXRlbS50eXBlIVwiIFtjb250ZW50VHlwZV09XCJpdGVtLmNvbnRlbnRUeXBlIVwiIC8+XG4gICAgICA8c3BhbiBtYXRUb29sdGlwU2hvd0RlbGF5PVwiNTAwXCIgW21hdFRvb2x0aXBdPVwiaXRlbS5uYW1lXCI+e3tpdGVtLm5hbWV9fTwvc3Bhbj5cbiAgICA8L2Rpdj5cblxuICAgIDxidXR0b24gbWF0LWljb24tYnV0dG9uIHR5cGU9XCJidXR0b25cIiAoY2xpY2spPVwiY2xvc2VQcmV2aWV3KClcIj5cbiAgICAgIDxtYXQtaWNvbiBmb250SWNvbj1cImNsb3NlXCIgLz5cbiAgICA8L2J1dHRvbj5cbiAgPC9kaXY+XG5cbiAgQGlmIChkb3dubG9hZFVSTCkge1xuICAgIDwhLS0gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEBhbmd1bGFyLWVzbGludC90ZW1wbGF0ZS9uby1jYWxsLWV4cHJlc3Npb24gLS0+XG4gICAgQGlmIChpdGVtLmNvbnRlbnRUeXBlPy5zdGFydHNXaXRoKCdpbWFnZS8nKSkge1xuICAgICAgPHBpY3R1cmUgY2xhc3M9XCJmaWxlLXByZXZpZXdcIj5cbiAgICAgICAgPGltZyBmaWxsIFtuZ1NyY109XCJkb3dubG9hZFVSTFwiIFthbHRdPVwiaXRlbS5mdWxsUGF0aFwiXG4gICAgICAgICAgICAgKGVycm9yKT1cImRvd25sb2FkVVJMPXVuZGVmaW5lZDtwcmV2aWV3RXJyb3I9dHJ1ZVwiIC8+XG4gICAgICA8L3BpY3R1cmU+XG4gICAgICA8IS0tIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvdGVtcGxhdGUvbm8tY2FsbC1leHByZXNzaW9uIC0tPlxuICAgIH0gQGVsc2UgaWYgKGl0ZW0uY29udGVudFR5cGU/LnN0YXJ0c1dpdGgoJ3ZpZGVvLycpKSB7XG4gICAgICA8dmlkZW8gY2xhc3M9XCJmaWxlLXByZXZpZXdcIiBjb250cm9scyBhdXRvcGxheSBsb29wPlxuICAgICAgICA8c291cmNlIFt0eXBlXT1cIml0ZW0uY29udGVudFR5cGVcIiBbc3JjXT1cImRvd25sb2FkVVJMXCJcbiAgICAgICAgICAgICAgICAoZXJyb3IpPVwiZG93bmxvYWRVUkw9dW5kZWZpbmVkO3ByZXZpZXdFcnJvcj10cnVlXCIvPlxuICAgICAgPC92aWRlbz5cbiAgICB9XG4gICAgPGRpdiBjbGFzcz1cImRvd25sb2FkLWJ0blwiPlxuICAgICAgPGEgbWF0LXN0cm9rZWQtYnV0dG9uIHR5cGU9XCJidXR0b25cIiBjb2xvcj1cInByaW1hcnlcIiB0YXJnZXQ9XCJfYmxhbmtcIiBbaHJlZl09XCJkb3dubG9hZFVSTFwiPlxuICAgICAgICA8bWF0LWljb24gZm9udEljb249XCJkb3dubG9hZFwiIC8+XG4gICAgICAgIDxzcGFuPkRvd25sb2FkPC9zcGFuPlxuICAgICAgPC9hPlxuICAgIDwvZGl2PlxuICB9XG4gIEBpZiAocHJldmlld0Vycm9yKSB7XG4gICAgPGgzIGNsYXNzPVwiZmlsZS1wcmV2aWV3XCI+UHJldmlldyBOb3QgQXZhaWxhYmxlLjwvaDM+XG4gIH1cblxuICA8ZGwgY2xhc3M9XCJtZXRhZGF0YVwiPlxuICAgIDxkdD5OYW1lPC9kdD5cbiAgICA8ZGQ+PGEgY2xhc3M9XCJkb3dubG9hZC1saW5rXCIgdGFyZ2V0PVwiX2JsYW5rXCIgW2hyZWZdPVwiZG93bmxvYWRVUkxcIj57e2l0ZW0ubmFtZX19PC9hPjwvZGQ+XG5cbiAgICA8ZHQ+U2l6ZTwvZHQ+XG4gICAgPGRkPnt7aXRlbS5zaXplIHwgZm9ybWF0Qnl0ZXN9fTwvZGQ+XG5cbiAgICA8ZHQ+VHlwZTwvZHQ+XG4gICAgPGRkPnt7aXRlbS5jb250ZW50VHlwZX19PC9kZD5cblxuICAgIDxkdD5DcmVhdGVkPC9kdD5cbiAgICA8ZGQ+e3tpdGVtLnRpbWVDcmVhdGVkIHwgZGF0ZTonc2hvcnQnfX08L2RkPlxuXG4gICAgPGR0Pkxhc3QgbW9kaWZpZWQ8L2R0PlxuICAgIDxkZD57e2l0ZW0udXBkYXRlZCB8IGRhdGU6J3Nob3J0J319PC9kZD5cbiAgPC9kbD5cbn1cbiJdfQ==