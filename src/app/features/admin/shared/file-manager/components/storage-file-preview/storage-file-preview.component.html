@if (item) {
  <div class="header">
    <div class="name">
      <aj-storage-item-icon [type]="item.type!" [contentType]="item.contentType!" />
      <span matTooltipShowDelay="500" [matTooltip]="item.name">{{item.name}}</span>
    </div>

    <button mat-icon-button type="button" (click)="_close.emit(undefined)">
      <mat-icon fontIcon="close" />
    </button>
  </div>

  @if (downloadURL) {
    <!-- eslint-disable-next-line @angular-eslint/template/no-call-expression -->
    @if (item.contentType?.startsWith('image/')) {
      <picture class="file-preview">
        <img fill [ngSrc]="downloadURL" [alt]="item.fullPath"
             (error)="downloadURL=undefined;previewError=true" />
      </picture>
      <!-- eslint-disable-next-line @angular-eslint/template/no-call-expression -->
    } @else if (item.contentType?.startsWith('video/')) {
      <video class="file-preview" controls autoplay loop>
        <source [type]="item.contentType" [src]="downloadURL"
                (error)="downloadURL=undefined;previewError=true"/>
      </video>
    }
  }
  @if (previewError) {
    <h3 class="file-preview">Preview Not Available.</h3>
  }

  <dl class="metadata">
    <dt>Name</dt>
    <dd><a target="_blank" [href]="downloadURL">{{item.name}}</a></dd>

    <dt>Size</dt>
    <dd>{{item.size | formatBytes}}</dd>

    <dt>Type</dt>
    <dd>{{item.contentType}}</dd>

    <dt>Created</dt>
    <dd>{{item.timeCreated | date:'short'}}</dd>

    <dt>Last modified</dt>
    <dd>{{item.updated | date:'short'}}</dd>
  </dl>
}
